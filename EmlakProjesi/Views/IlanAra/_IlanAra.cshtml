
@{
    ViewBag.Title = "_IlanAra";
}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <link rel="apple-touch-icon" sizes="76x76" href="~/assets/img/apple-icon.png" />
    <link rel="icon" type="image/png" href="~/assets/img/favicon.png" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>İLAN KAYDI</title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />
    <!-- Bootstrap core CSS     -->
    <link href="~/assets/css/bootstrap.min.css" rel="stylesheet" />
    <!--  Material Dashboard CSS    -->
    <link href="~/assets/css/material-dashboard.css?v=1.2.0" rel="stylesheet" />
    <!--  CSS for Demo Purpose, don't include it in your project     -->
    <link href="~/assets/css/demo.css" rel="stylesheet" />
    <!--     Fonts and icons     -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,700,300|Material+Icons" rel='stylesheet'>
    <script src="http://maps.google.com/maps/api/js?sensor=false"
            type="text/javascript"></script>
</head>
<body>
    @RenderBody()
    <div class="wrapper">
        @Html.Partial("_SideBar");
        <div class="main-panel">
            <nav class="navbar navbar-transparent navbar-absolute">

            </nav>
            <div class="content">
                <div class="container-fluid">
                    <div class="row">
                        @model EmlakProjesi.ModelView.IlanAraModel
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header" data-background-color="purple">
                                    <h4 class="title">İlan Ara</h4>
                                    <p class="category">İstediğiniz Özellikleri Giriniz</p>
                                </div>
                                <div class="card-content">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group label-floating">
                                                <label class="control-label">İL</label>
                                                @Html.DropDownListFor(model => model.Adres.IL_ID, ViewBag.Iller as SelectList, new { @class = "form-control" })
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group label-floating">
                                                <label class="control-label">İLÇE</label>
                                                <!--<select id="ilceler" class="form-control"></select>-->
                                                 @Html.DropDownListFor(model => model.Adres.ILCE_ID, ViewBag.Ilceler as SelectList, new {@id = "ilceid",  @class = "form-control"})

                                            </div>
                                        </div>
                                    </div>

                                    <!-- oda sayısı banyo sayısı-->
                                    <div class="row">
                                        <div class="col-lg-3 col-md-4 col-sm-6">
                                            <div class="title">
                                                <h3>Oda Sayısı</h3>
                                            </div>
                                            <div class="form-check">
                                                <label class="form-check-label">
                                                    <input class="form-check-input" type="checkbox" value="" id="odasayisi1"> 2+1
                                                    <span class="form-check-sign">
                                                        <span class="check"></span>
                                                    </span>
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <label class="form-check-label">
                                                    <input class="form-check-input" type="checkbox" value="" id="odasayisi2"> 3+1
                                                    <span class="form-check-sign">
                                                        <span class="check"></span>
                                                    </span>
                                                </label>
                                            </div>
                                        </div>

                                        <div class="col-lg-3 col-md-4 col-sm-6">
                                            <div class="title">
                                                <h3>Banyo Sayısı</h3>
                                            </div>
                                            <div class="form-check">
                                                <label class="form-check-label">
                                                    <input class="form-check-input" type="checkbox" id="banyosayisi1" value=""> 1
                                                    <span class="form-check-sign">
                                                        <span class="check"></span>
                                                    </span>
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <label class="form-check-label">
                                                    <input class="form-check-input" type="checkbox" id="banyosayisi2" value=""> 2
                                                    <span class="form-check-sign">
                                                        <span class="check"></span>
                                                    </span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- oda sayısı banyos sayısı son-->
                                    <!-- fiyat esya bilgisi-->

                                    <div class="row">
                                        
                                        <div class="col-lg-3 col-sm-4">
                                            <div class="form-group has-default">
                                                <div class="title">
                                                    <h3>Fiyat Bilgisi</h3>
                                                </div>
                                                <input type="text" class="form-control" id="minfiyat" placeholder="Min Fiyat">
                                                <input type="text" class="form-control" id="maxfiyat" placeholder="Max Fiyat">
                                            </div>
                                        </div>
                                        <!--yeni-->
                                        <div class="col-lg-3 col-sm-4">
                                            <div class="form-group has-default">
                                                <div class="title">
                                                    <h3>Eşyalı</h3>
                                                </div>
                                                <div class="form-group label-floating">
                                                    <label class="control-label">EŞYALI</label>
                                                    @Html.DropDownListFor(model => model.Ilan.ESYALI, EmlakProjesi.ModelView.IlanKayitModel.GetEsya(), new { @class = "form-control", @id = "esyali" })
                                                </div>

                                            </div>

                                        </div>

                                        <div class="col-lg-3 col-sm-4">
                                            <div class="form-group has-default">
                                                <div class="title">
                                                    <h3>Kategori</h3>
                                                </div>
                                                <div class="form-group label-floating">
                                                    <label class="control-label">KATEGORİ</label>
                                                    @Html.DropDownListFor(model => model.Ilan.KATEGORI_ID, ViewBag.Kategoriler as SelectList, new { @class = "form-control", @id = "kategori" })
                                                </div>



                                            </div>

                                        </div>




                                    </div>
                                    <!-- fiyat esya bilgisi son-->

                                    <input type="submit" id="ara-btn" class="btn btn-primary pull-right" value="ARA" name="Gonder" />

                                    <div class ="row" id="boxIlanlar"></div>

                                    <!-- burası ılan arama tasarımı-->
                                    <div class="row">
                                        <div class="col-md-12">
                                            <div class="card card-nav-tabs">
                                                <div class="card-header" data-background-color="purple">
                                                    <div class="nav-tabs-navigation">
                                                        <div class="nav-tabs-wrapper">
                                                            <span class="nav-tabs-title"></span>
                                                            <ul class="nav nav-tabs" data-tabs="tabs">
                                                                <li class="active">
                                                                    <a href="#profile" data-toggle="tab">
                                                                        <i class="material-icons">list</i> ARAMA SONUÇLARI
                                                                        <div class="ripple-container"></div>
                                                                    </a>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="card-content">
                                                    <div class="tab-content">
                                                        <div class="tab-pane active" id="profile">
                                                            <table class="table">
                                                                <thead class="text-warning">
                                                                <th>IL</th>
                                                                <th>ILCE</th>
                                                                <th>FIYAT</th>
                                                                <th>KATEGORI</th>
                                                                <th>ACIKLAMA</th>

                                                                </thead>
                                                                <tbody>

                                                                    <tr>
                                                                        <td id="ilan-il"></td>
                                                                        <td id="ilan-ilce"></td>
                                                                        <td id="ilan-fiyat"></td>
                                                                        <td id="ilan-kategori"></td> 
                                                                        <td id="ilan-aciklama"></td>


                                                                    </tr>

                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                    <!--sonu-->

                                    <div class="clearfix"></div>
                                </div>
                            </div>
                        </div>


                    </div>
                    
                </div>
            </div>
            @Html.Partial("_Footer");
        </div>
    </div>
    <!--   Core JS Files   -->


    <script src="~/login_css/vendor/jquery/jquery-3.2.1.min.js"></script>
    <!--===============================================================================================-->
    <script type="text/javascript">
       
        var ilceno;
        var globalIlanlar;

        $(document).ready(function () {
            $('#ara-btn').click(function () {

                var cityId = $('#Adres_IL_ID').val();
                var ilceId = $('#ilceid').val();

                var tut = document.getElementById("Adres_IL_ID");
                var cityname = tut.options[tut.selectedIndex].text;

                var tut2 = document.getElementById("ilceid");
                var ilcename = tut2.options[tut2.selectedIndex].text;

                var odasayisi1 = document.getElementById("odasayisi1").checked
                var odasayisi2 = document.getElementById("odasayisi2").checked

                var banyosayisi1 = document.getElementById("banyosayisi1").checked
                var banyosayisi2 = document.getElementById("banyosayisi2").checked

                var minfiyat = document.getElementById("minfiyat").value;
                var maxfiyat = document.getElementById("maxfiyat").value;

                var esyaliId = $('#esyali').val();
                var kategoriId = $('#kategori').val();

                var result = [cityId, ilceId, odasayisi1, odasayisi2, banyosayisi1, banyosayisi2, minfiyat, maxfiyat, esyaliId, kategoriId];

                var ilanArr = result;
                var yenijson = JSON.stringify(result);

                $.post("GetistenenOzellikler", {
                    yenijson: "" + yenijson,
                }, function (data, status) {
                    console.log("bunu yazdı: --->" + yenijson);
                });

              
                $.post("AktifIlanlar", {
                    gelenozellikler: ilanArr,
                }, function (dataIlanlar, status) {
                    globalIlanlar = dataIlanlar;
                    for (i = 0; i < globalIlanlar.length; i++) {
                        if ((globalIlanlar[i].IL === cityname) && globalIlanlar[i].ILCE === ilcename) {
                            console.log("girsi");
                            console.log(maxfiyat);
                            if ((parseInt(globalIlanlar[i].FIYAT)) <= maxfiyat) {
                                if ((parseInt(globalIlanlar[i].FIYAT)) >= minfiyat) {
                                    console.log("girsi2");
                                    $("#ilan-il").append(globalIlanlar[i].IL);
                                    $("#ilan-il").append("</br>");
                                    $("#ilan-ilce").append(globalIlanlar[i].ILCE);
                                    $("#ilan-ilce").append("</br>");
                                    $("#ilan-fiyat").append(globalIlanlar[i].FIYAT);
                                    $("#ilan-fiyat").append("</br>");
                                    $("#ilan-kategori").append(globalIlanlar[i].KATEGORI);
                                    $("#ilan-kategori").append("</br>");
                                    if (globalIlanlar[i].ACIKLAMA != "") {
                                        $("#ilan-aciklama").append(globalIlanlar[i].ACIKLAMA);
                                        $("#ilan-aciklama").append("</br>");
                                    }
                                    else {
                                        $("#ilan-aciklama").append("ACIKLAMA YOK");
                                        $("#ilan-aciklama").append("</br>");
                                    }
                                        
                                   
                                }
                               
                            }
                        }
                    }
                });

                

            });



            //function SetCityAreaList() {
            //    var cityId = $('#Adres_IL_ID').val();
            //    var globalData = "";
            //    $("#ilceler").empty();

            //    $.post("GetCityAreas", {
            //        cityId: "" + cityId
                  
            //    }, function (data, status) {
            //        console.log(data);
            //        globalData = JSON.parse(data);
                    
            //        for (i = 0; i < globalData[0].IL.ILCE.length; i++) {
            //            var k = globalData[0].IL.ILCE[i];
            //            $("#ilceler").append('<option>' + k.ADI + '</option>');
            //        }
                   
            //        getılceId();
                    
            //    });
            //}


            //$('#Adres_IL_ID').change(function () {
            //    $("#ilceler").empty();
            //    SetCityAreaList();
                
            //});


            //function getılceId() {
            //    $('#ilceler').change(function () {

            //        var x = document.getElementById("ilceler").selectedIndex;
            //        var y = document.getElementById("ilceler").options;
            //        ilceno = y[x].index;
            //        alert(ilceno);
            //    });
            //}
           


        });


    </script>





    <script src="~/assets/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="~/assets/js/material.min.js" type="text/javascript"></script>
    <!--  Charts Plugin -->
    <script src="~/assets/js/chartist.min.js"></script>
    <!--  Dynamic Elements plugin -->
    <script src="~/assets/js/arrive.min.js"></script>
    <!--  PerfectScrollbar Library -->
    <script src="~/assets/js/perfect-scrollbar.jquery.min.js"></script>
    <!--  Notifications Plugin    -->
    <script src="~/assets/js/bootstrap-notify.js"></script>
    <!--  Google Maps Plugin    -->
    <!-- Material Dashboard javascript methods -->
    <script src="~/assets/js/material-dashboard.js?v=1.2.0"></script>
    <!-- Material Dashboard DEMO methods, don't include it in your project! -->
    <script src="~/assets/js/demo.js"></script>



</body>
</html>
